<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Détails de l'apprenti</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/detail.css}">
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<div class="container">
    <div th:if="${successMessage != null}" class="alert alert-success">
        <p th:text="${successMessage}"></p>
    </div>

    <div class="logout-section">
        <a th:href="@{/apprentices}" class="btn-back">← Retour</a>
    </div>

    <div class="detail-header">
        <h2 th:text="${apprentice.firstName + ' ' + apprentice.lastName}">Nom Prénom</h2>
        <div class="header-actions">
            <a th:href="@{/apprentices/{id}/edit(id=${apprentice.id})}" class="btn btn-primary">Modifier</a>
        </div>
    </div>

    <div class="detail-grid">

        <!-- Données personnelles -->
        <section class="detail-card">
            <h3>Informations personnelles</h3>
            <div class="detail-row">
                <span class="label">Nom :</span>
                <span class="value" th:text="${apprentice.lastName}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Prénom :</span>
                <span class="value" th:text="${apprentice.firstName}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Email :</span>
                <span class="value" th:text="${apprentice.email}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Téléphone :</span>
                <span class="value" th:text="${apprentice.phoneNumber}">-</span>
            </div>
        </section>

        <!-- École -->
        <section class="detail-card">
            <h3>Formation</h3>
            <div class="detail-row">
                <span class="label">Programme :</span>
                <span class="value" th:text="${apprentice.program}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Spécialité :</span>
                <span class="value"><span class="badge" th:text="${apprentice.major}">-</span></span>
            </div>
            <div class="detail-row">
                <span class="label">Année académique :</span>
                <span class="value" th:text="${apprentice.academicYear}">-</span>
            </div>
        </section>

        <!-- Entreprise -->
        <section class="detail-card" th:if="${apprentice.company != null}">
            <h3>Entreprise</h3>
            <div class="detail-row">
                <span class="label">Raison sociale :</span>
                <span class="value" th:text="${apprentice.company.socialReason}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Adresse :</span>
                <span class="value" th:text="${apprentice.company.address}">-</span>
            </div>
            <div class="detail-row long-text" th:if="${apprentice.company.accessInformation != null}">
                <span class="label">Accès :</span>
                <span class="value" th:text="${apprentice.company.accessInformation}">-</span>
            </div>
        </section>

        <!-- Maître d'apprentissage -->
        <section class="detail-card" th:if="${apprentice.master != null}">
            <h3>Maître d'apprentissage</h3>
            <div class="detail-row">
                <span class="label">Nom :</span>
                <span class="value" th:text="${apprentice.master.lastName + ' ' + apprentice.master.firstName}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Poste :</span>
                <span class="value" th:text="${apprentice.master.position}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Email :</span>
                <span class="value" th:text="${apprentice.master.email}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Téléphone :</span>
                <span class="value" th:text="${apprentice.master.phoneNumber}">-</span>
            </div>
        </section>

        <!-- Mission -->
        <section class="detail-card" th:if="${apprentice.mission != null}">
            <h3>Mission</h3>
            <div class="detail-row">
                <span class="label">Métier :</span>
                <span class="value" th:text="${apprentice.mission.profession}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Mots-clés :</span>
                <span class="value" th:text="${apprentice.mission.keywords}">-</span>
            </div>
            <div class="detail-row long-text" th:if="${apprentice.mission.comments != null}">
                <span class="label">Commentaires :</span>
                <span class="value" th:text="${apprentice.mission.comments}">-</span>
            </div>
        </section>

        <!-- Visite -->
        <section class="detail-card" th:if="${apprentice.visit != null}">
            <h3>Visite</h3>
            <div class="detail-row">
                <span class="label">Date :</span>
                <span class="value" th:text="${#temporals.format(apprentice.visit.date, 'dd/MM/yyyy')}">-</span>
            </div>
            <div class="detail-row">
                <span class="label">Format :</span>
                <span class="value"
                      th:text="${apprentice.visit.format == T(org.myfss.model.enums.Format).FACE_TO_FACE ? 'Présentiel' : 'Visio'}">
                </span>
            </div>
            <div class="detail-row long-text" th:if="${apprentice.visit.comments != null}">
                <span class="label">Commentaires :</span>
                <span class="value" th:text="${apprentice.visit.comments}">-</span>
            </div>
        </section>

        <!-- Évaluation -->
        <section class="detail-card full-width" th:if="${apprentice.evaluation != null}">
            <h3>Évaluation</h3>

            <!-- Mémoire -->
            <div th:if="${apprentice.evaluation.report != null}">
                <h4>Mémoire</h4>
                <div class="detail-row">
                    <span class="label">Thème :</span>
                    <span class="value" th:text="${apprentice.evaluation.report.theme}">-</span>
                </div>
                <div class="detail-row">
                    <span class="label">Note :</span>
                    <span class="value" th:text="${apprentice.evaluation.report.grade}">-</span>
                </div>
                <div class="detail-row" th:if="${apprentice.evaluation.report.comments != null}">
                    <span class="label">Commentaires :</span>
                    <span class="value" th:text="${apprentice.evaluation.report.comments}">-</span>
                </div>
            </div>

            <!-- Oral -->
            <div th:if="${apprentice.evaluation.oral != null}" class="evaluation-section" style="margin-top: 20px;">
                <h4>Oral</h4>
                <div class="detail-row">
                    <span class="label">Date :</span>
                    <span class="value"
                          th:text="${#temporals.format(apprentice.evaluation.oral.date, 'dd/MM/yyyy')}">-</span>
                </div>
                <div class="detail-row">
                    <span class="label">Note :</span>
                    <span class="value" th:text="${apprentice.evaluation.oral.grade}">-</span>
                </div>
                <div class="detail-row" th:if="${apprentice.evaluation.oral.comments != null}">
                    <span class="label">Commentaires :</span>
                    <span class="value" th:text="${apprentice.evaluation.oral.comments}">-</span>
                </div>
            </div>
        </section>

        <!-- Commentaires -->
        <section class="detail-card full-width" th:if="${apprentice.comments != null}">
            <h3>Commentaires</h3>
            <p class="text-content" th:text="${apprentice.comments}">-</p>
        </section>

        <section class="detail-card full-width" th:if="${apprentice.tutorFeedback != null}">
            <h3>Retour du tuteur</h3>
            <p class="text-content" th:text="${apprentice.tutorFeedback}">-</p>
        </section>
    </div>
</div>

</body>
</html>